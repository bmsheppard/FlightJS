(()=>{"use strict";class t{constructor(t,i){this.name="xBoost",this.x=t,this.y=i,this.width=80,this.height=20,this.color="#8AC926"}}class i{constructor(t,i){this.name="fullBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#FCF300"}}class s{constructor(t,i){this.name="halfBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#F9627D"}}function h(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t)+t)}class e{constructor(t,i,s,h){this.startY=i,this.x=t,this.y=i,this.width=s,this.height=h,this.color="#F7F4EA"}}var o=document.getElementById("gameWindow"),d=o.getContext("2d");const a=o.height/2,n=o.width/8,l=o.width/2,c=-10*o.height,r=o.height-20;var u=new class{constructor(t,i){this.size=20,this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.maxVelY=40,this.lost=!1,this.dt=.5}draw(){var t=document.getElementById("gameWindow"),i=t.getContext("2d");let s=t.height/2,h=t.width/8;i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fillStyle="#FF9505",i.fill(),i.closePath(),i.restore(),this.vx>0?this.vx-=this.ax*this.dt:this.vx=0,this.x+=this.vx,i.translate(-this.vx,0),this.vy!==this.maxVelY&&(this.vy+=this.ay*this.dt),this.y<t.height-this.size||this.vy<0?(this.y+=this.vy*this.dt,this.y<s?i.translate(0,-this.vy*this.dt):(i.setTransform(1,0,0,1,0,0),i.translate(h-this.x,0))):0!==this.bounceType?(this.vy=-this.bounceType*this.vy,this.bounceType=0):(this.vy=0,this.lost=!0)}reset(t,i){this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.lost=!1}flap(){if(0===this.vx&&0===this.vy)return this.vx=15,this.ax=.1,this.vy=-10,void(this.ay=1);this.vy=-15,this.vx+=2}applyItem(t){"xBoost"===t?this.giveBoost():"fullBounce"===t?this.giveBounce(1.5):"halfBounce"===t&&this.giveBounce(.75)}giveBounce(t){this.bounceType=t}giveBoost(){this.vx+=20}giveLastChance(){console.log("Does nothing right now")}}(n,a),g=new class{constructor(){this.items=[]}drawItems(t,i,s){var h="",e=document.getElementById("gameWindow").getContext("2d");this.items.length>0&&this.items[0].width+this.items[0].x<t&&this.items.shift();for(let o of this.items){let d=10,a=o.x-d,n=o.x+o.width+d,l=o.y-d,c=o.y+o.height+d;i<n&&i>a&&s<c&&s>l&&(h=o.name,o.x=t-o.width),e.beginPath(),e.rect(o.x,o.y,o.width,o.height),e.fillStyle=o.color,e.fill(),e.closePath()}return h}},v=new class{constructor(t,i){this.groundObjs=[0,t,2*t],this.y=i,this.heigth=50,this.canvas=document.getElementById("gameWindow")}draw(t){var i=this.canvas.getContext("2d");this.groundObjs[0]+this.canvas.width<t&&(this.groundObjs.shift(),this.groundObjs.push(this.groundObjs[this.groundObjs.length-1]+this.canvas.width));for(const t of this.groundObjs){let s=10*t/this.canvas.width;i.beginPath(),i.rect(t,this.canvas.height-20,this.canvas.width,50),i.rect(t,this.canvas.height-40,10,60),i.font="20px Roboto",i.fillStyle="#4A5899",i.fillText(s+"m",t,this.canvas.height-50),i.fill(),i.closePath()}}addHorizontalMarkers(t,i,s){var h=this.canvas.getContext("2d");for(let e=1;e<50;++e){let o=this.canvas.height-e*i,d=5*e;Math.abs(s-o)<this.canvas.height&&(h.beginPath(),h.rect(t,o,this.canvas.width,2),h.fillStyle="#090809",h.font="20px Roboto",h.fillText(d+"m",t,o-2),h.fill(),h.closePath())}}addObj(t){this.groundObjs.push(t)}}(o.width,r),y=new class{constructor(){this.clouds=[],this.addCloud=this.addCloud.bind(this)}addCloud(t,i,s){let o=h(s=Math.min(s,0),i-300+s),d=new e(t,o,300,100);this.clouds.push(d)}resetClouds(){this.clouds[0].x=h(10,this.clouds[0].width);for(let t=1;t<this.clouds.length;++t)this.clouds[t].x=this.clouds[t-1].x+h(this.clouds[t-1].width+100,this.clouds[t-1].width+600)}draw(t,i,s){var e=document.getElementById("gameWindow"),o=e.getContext("2d");for(let t of this.clouds)t.x=t.x+.8*i,t.y=t.y+.2*s,o.beginPath(),o.rect(t.x,t.y,t.width,t.height),o.fillStyle=t.color,o.fill(),o.closePath();if(0!=this.clouds.length&&this.clouds[0].x<t-this.clouds[0].width){let i=h(e.width,e.width+100);this.addCloud(t+i,e.height,this.clouds[0].y-this.clouds[0].startY),this.clouds.shift()}}};y.addCloud(h(0,o.width/4),o.height,0),y.addCloud(h(o.width/2,o.width),o.height,0),o.width,o.width;var w=!1;!function e(){var x=u.x-n,m=u.y-a;if(w){let e=h(0,80+500/u.vx),d=x+o.width,a=Math.max(m-2*o.height,c),n=h(Math.min(m+2*o.height,r-100),a);e<3?g.items.push(new t(d,n)):e<6?g.items.push(new i(d,n)):e<9&&g.items.push(new s(d,n))}d.clearRect(x,m-o.height,o.width,2*o.height),v.draw(x),u.y>=o.height/2?y.draw(x,u.vx,0):y.draw(x,u.vx,u.vy),function(t){v.addHorizontalMarkers(t,l,u.y)}(x);let f=g.drawItems(x,u.x,u.y);""!==f&&u.applyItem(f),u.draw(),u.lost&&(alert("Game over!"),u.reset(n,a),w=!1,g.items=[],v.groundObjs=[0,o.width,2*o.width],y.resetClouds()),requestAnimationFrame(e)}(),document.addEventListener("keydown",(function(t){32===t.keyCode&&(u.flap(),w=!0)})),document.addEventListener("keydown",(function(t){65===t.keyCode?u.giveBounce():83===t.keyCode||68===t.keyCode?u.giveBoost():70===t.keyCode&&u.giveLastChance()}))})();