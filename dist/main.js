(()=>{"use strict";class t{constructor(t,i){this.name="xBoost",this.x=t,this.y=i,this.width=80,this.height=20,this.color="#8AC926"}}class i{constructor(t,i){this.name="yBoost",this.x=t,this.y=i-100,this.width=40,this.height=120,this.color="#CDE7B0"}}class h{constructor(t,i){this.name="fullBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#FCF300"}}class s{constructor(t,i){this.name="halfBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#F9627D"}}class e{constructor(t,i){this.name="fullEnergy",this.x=t,this.y=i,this.width=40,this.height=40,this.color="purple"}}class o{constructor(t,i){this.name="lastChance",this.x=t,this.y=i-40,this.width=80,this.height=40,this.color="#FFBA08"}}function a(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t)+t)}const n=196;class r{constructor(t,i,h,s){this.startY=i,this.x=t,this.y=i,this.width=h,this.height=s,this.color="#F7F4EA"}}var l=document.getElementById("gameWindow"),d=l.getContext("2d");const c=l.height-30,g=l.width/8,y=l.width/2,u=-10*l.height,w=l.height-60;var v=new class{constructor(t,i,h){this.size=20,this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.arrowEndX=t+30,this.arrowEndY=i-30,this.maxVelY=40,this.lost=!1,this.dt=.5,this.dir="grow",this.groundHeight=h,this.bounceType=0,this.energyY=20,this.energyX=n,this.color="#FF9505",this.drawEnergy=this.drawEnergy.bind(this),this.shouldSkip=this.shouldSkip.bind(this),this.giveLastChance=this.giveLastChance.bind(this),this.startGame=this.startGame.bind(this)}draw(t=!1){var i=document.getElementById("gameWindow"),h=i.getContext("2d");let s=i.height/2,e=i.width/8;if(t){h.beginPath(),h.arc(this.x,i.height-this.size-10,this.size,0,2*Math.PI),h.fillStyle=this.color,h.fill(),h.closePath();let t=this.x,s=i.height-10-this.size;return"shrink"===this.dir?(this.arrowEndY+=1,this.arrowEndX-=1,this.arrowEndY>i.height-this.size-30&&(this.dir="grow")):"grow"===this.dir&&(this.arrowEndY-=1,this.arrowEndX+=1,this.arrowEndY<i.height-this.size-90&&(this.dir="shrink")),function(t,i,h,s,e){var o=document.getElementById("gameWindow").getContext("2d");let a=s-i,n=e-h,r=Math.atan2(n,a);o.save(),o.moveTo(i,h),o.lineTo(s,e),o.lineTo(s-20*Math.cos(r-Math.PI/6),e-20*Math.sin(r-Math.PI/6)),o.moveTo(s,e),o.lineTo(s-20*Math.cos(r+Math.PI/6),e-20*Math.sin(r+Math.PI/6)),o.strokeStyle="#FF9505",o.stroke(),o.closePath()}(0,t,s,this.arrowEndX,this.arrowEndY),void h.setTransform(1,0,0,1,0,0)}h.beginPath(),h.arc(this.x,this.y,this.size,0,2*Math.PI),h.fillStyle=this.color,h.fill(),h.closePath(),this.drawEnergy(i),this.vx>0?this.vx-=this.ax*this.dt:this.vx=0,this.x+=this.vx,h.translate(-this.vx,0),this.vy!==this.maxVelY&&(this.vy+=this.ay*this.dt),this.y<this.groundHeight||this.vy<0?(this.y+=this.vy*this.dt,this.y<s?(h.translate(0,-this.vy*this.dt),this.energyY+=this.vy*this.dt):(h.setTransform(1,0,0,1,0,0),h.translate(e-this.x,0),this.energyY=20)):0!==this.bounceType?(this.vy=-this.bounceType*this.vy,this.bounceType=0,this.color="#FF9505"):this.shouldSkip()?this.vy=-1*Math.abs(this.vy):(this.vy=0,this.x=0,this.lost=!0)}drawEnergy(t){this.lost||(this.energyX=Math.min(n,this.energyX+.4));var i=t.getContext("2d");i.beginPath(),i.rect(this.x+t.width-350,this.energyY,200,20),i.fillStyle="#090809",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348,this.energyY+2,this.energyX,16),i.fillStyle="#D7263D",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348+25,this.energyY-2,2,20),i.fillStyle="#FF9505",i.fill(),i.closePath()}shouldSkip(){return console.log(this.vx,Math.atan(this.vy/this.vx)),Math.atan(this.vy/this.vx)<.52&&this.vx>10}reset(t,i){this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.lost=!1,this.energyX=n}flap(){0!==this.vx||0!==this.vy?this.energyX>=25&&(this.energyX=Math.max(this.energyX-25,0),this.vy=Math.max(this.vy-15,-20),this.vx=Math.min(this.vx+3,35)):this.startGame()}startGame(){this.energyX=n,this.ax=.2,this.vx=.5*(this.arrowEndX-this.x),this.vy=Math.min(this.arrowEndY-this.y+20,-15),this.ay=1}applyItem(t){"xBoost"===t?this.giveBoost():"fullBounce"===t?(this.giveBounce(1.5),this.color="#FCF300"):"halfBounce"===t?(this.giveBounce(.75),this.color="#F9627D"):"fullEnergy"===t?this.energyX=n:"yBoost"==t?(this.vy-=5,this.vx=Math.max(this.vx,5)):"lastChance"==t&&this.giveLastChance()}giveBounce(t){this.bounceType=t}giveBoost(){this.vx=Math.min(this.vx+20,35)}giveLastChance(){this.vx=Math.max(30,this.vx+10),this.vy=-35}}(g,c,w),x=new class{constructor(){this.items=[],this.notSpecialItem=this.notSpecialItem.bind(this)}drawItems(t,i,h){var s="",e=document.getElementById("gameWindow").getContext("2d");this.items.length>0&&this.items[0].width+this.items[0].x<t&&this.items.shift();for(let o of this.items){let a=10,n=o.x-a,r=o.x+o.width+a,l=o.y-a,d=o.y+o.height+a;i<r&&i>n&&h<d&&h>l&&(s=o.name,this.notSpecialItem(o.name)&&(o.x=t-o.width)),e.beginPath(),e.rect(o.x,o.y,o.width,o.height),e.fillStyle=o.color,e.fill(),e.closePath()}return s}notSpecialItem(t){return"yBoost"!==t}},m=new class{constructor(t,i){this.groundObjs=[0,t,2*t],this.y=i,this.heigth=100,this.canvas=document.getElementById("gameWindow")}draw(t){var i=this.canvas.getContext("2d");this.groundObjs[0]+this.canvas.width<t&&(this.groundObjs.shift(),this.groundObjs.push(this.groundObjs[this.groundObjs.length-1]+this.canvas.width));for(const t of this.groundObjs){let h=10*t/this.canvas.width;i.beginPath(),i.rect(t,this.y,this.canvas.width,100),i.rect(t,this.y-20,10,60),i.font="20px Roboto",i.fillStyle="#4A5899",i.fillText(h+"m",t,this.y-40),i.fill(),i.closePath()}}addHorizontalMarkers(t,i,h){var s=this.canvas.getContext("2d");for(let e=1;e<50;++e){let o=this.canvas.height-e*i,a=5*e;Math.abs(h-o)<this.canvas.height&&(s.beginPath(),s.rect(t,o,this.canvas.width,2),s.fillStyle="#090809",s.font="20px Roboto",s.fillText(a+"m",t,o-2),s.fill(),s.closePath())}}addObj(t){this.groundObjs.push(t)}}(l.width,w),f=new class{constructor(){this.clouds=[],this.addCloud=this.addCloud.bind(this)}addCloud(t,i,h){let s=a(h=Math.min(h,0),i-300+h),e=new r(t,s,300,100);this.clouds.push(e)}resetClouds(){this.clouds[0].x=a(10,this.clouds[0].width);for(let t=1;t<this.clouds.length;++t)this.clouds[t].x=this.clouds[t-1].x+a(this.clouds[t-1].width+100,this.clouds[t-1].width+600)}draw(t,i,h){var s=document.getElementById("gameWindow"),e=s.getContext("2d");e.save(),e.globalCompositeOperation="destination-over",e.globalAlpha=.8;for(let t of this.clouds)t.x=t.x+.8*i,t.y=t.y+.2*h,e.beginPath(),e.rect(t.x,t.y,t.width,t.height),e.fillStyle=t.color,e.fill(),e.closePath();if(e.restore(),0!=this.clouds.length&&this.clouds[0].x<t-this.clouds[0].width){let i=a(s.width,s.width+100);this.addCloud(t+i,s.height,this.clouds[0].y-this.clouds[0].startY),this.clouds.shift()}}};f.addCloud(a(0,l.width/4),l.height,0),f.addCloud(a(l.width/2,l.width),l.height,0),l.width,l.width;var b=!1;!function n(){var r=v.x-g,p=v.y-l.height/2;if(b){d.clearRect(r,p-l.height,l.width+100,2*l.height);let n=a(0,100+500/v.vx),C=r+l.width,M=Math.max(p-2*l.height,u),E=a(Math.min(p+2*l.height,w-100),M);n<3?x.items.push(new t(C,E)):n<4?x.items.push(new h(C,E)):n<6?x.items.push(new s(C,E)):n<8?x.items.push(new e(C,E)):n<18?x.items.push(new i(C,E)):n<19&&x.items.push(new o(C,w)),m.draw(r),function(t){m.addHorizontalMarkers(t,y,v.y)}(r);let P=x.drawItems(r,v.x,v.y);""!==P&&v.applyItem(P),v.draw(),v.y>=l.height/2?f.draw(r,v.vx,0):f.draw(r,v.vx,v.vy),v.lost&&(d.clearRect(r,p-l.height,l.width+100,2*l.height),v.reset(g,c),alert("Game over!"),b=!1,x.items=[],m.groundObjs=[0,l.width,2*l.width],f.resetClouds())}else d.clearRect(0,p-l.height,l.width+100,2*l.height),m.draw(r),v.draw(!0),f.draw(r,-1,0);requestAnimationFrame(n)}(),document.addEventListener("keydown",(function(t){32===t.keyCode?(v.flap(),b=!0):27===t.keyCode||80===t.keyCode?pauseGame():65===t.keyCode?v.giveLastChance():83===t.keyCode&&v.giveBoost()}))})();