(()=>{"use strict";class t{constructor(t,i){this.name="xBoost",this.x=t,this.y=i,this.width=80,this.height=20,this.color="#8AC926"}}class i{constructor(t,i){this.name="yBoost",this.x=t,this.y=i-100,this.width=40,this.height=120,this.color="#CDE7B0"}}class s{constructor(t,i){this.name="fullBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#FCF300"}}class h{constructor(t,i){this.name="halfBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#F9627D"}}class e{constructor(t,i){this.name="fullEnergy",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#E39EC1"}}class o{constructor(t,i){this.name="lastChance",this.x=t,this.y=i-40,this.width=80,this.height=40,this.color="#FFBA08"}}const a=196;function n(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t)+t)}class l{constructor(t,i,s,h){this.startY=i,this.x=t,this.y=i,this.width=s,this.height=h,this.color="#F7F4EA"}}var d=document.getElementById("gameWindow"),r=d.getContext("2d");const c=d.height/2,g=d.width/8,y=d.width/2,u=-10*d.height,v=d.height-20;var x=new class{constructor(t,i){this.size=20,this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.maxVelY=40,this.lost=!1,this.dt=.5,this.bounceType=0,this.energyY=20,this.energyX=a,this.color="#FF9505",this.drawEnergy=this.drawEnergy.bind(this),this.shouldSkip=this.shouldSkip.bind(this),this.giveLastChance=this.giveLastChance.bind(this)}draw(){var t=document.getElementById("gameWindow"),i=t.getContext("2d");let s=t.height/2,h=t.width/8;this.drawEnergy(t),i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fillStyle=this.color,i.fill(),i.closePath(),i.restore(),this.vx>0?this.vx-=this.ax*this.dt:this.vx=0,this.x+=this.vx,i.translate(-this.vx,0),this.vy!==this.maxVelY&&(this.vy+=this.ay*this.dt),this.y<t.height-this.size||this.vy<0?(this.y+=this.vy*this.dt,this.y<s?(i.translate(0,-this.vy*this.dt),this.energyY+=this.vy*this.dt):(i.setTransform(1,0,0,1,0,0),i.translate(h-this.x,0),this.energyY=20)):0!==this.bounceType?(this.vy=-this.bounceType*this.vy,this.bounceType=0,this.color="#FF9505"):this.shouldSkip()?this.vy=-1*Math.abs(this.vy):(console.log(Math.atan(this.vy/this.vx)),this.vy=0,this.lost=!0)}drawEnergy(t){this.lost||(this.energyX=Math.min(a,this.energyX+.4));var i=t.getContext("2d");i.beginPath(),i.rect(this.x+t.width-350,this.energyY,200,20),i.fillStyle="#090809",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348,this.energyY+2,this.energyX,16),i.fillStyle="#D7263D",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348+30,this.energyY-2,2,20),i.fillStyle="#FF9505",i.fill(),i.closePath()}shouldSkip(){return Math.atan(this.vy/this.vx)<.52}reset(t,i){this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.lost=!1,this.energyX=a}flap(){if(0===this.vx&&0===this.vy)return this.energyX=Math.max(this.energyX-30,0),this.vx=25,this.ax=.1,this.vy=-20,void(this.ay=1);this.energyX>=30&&(this.energyX=Math.max(this.energyX-30,0),this.vy-=15,this.vx+=2)}applyItem(t){"xBoost"===t?this.giveBoost():"fullBounce"===t?(this.giveBounce(1.5),this.color="#FCF300"):"halfBounce"===t?(this.giveBounce(.75),this.color="#F9627D"):"fullEnergy"===t?this.energyX=a:"yBoost"==t?(this.vy-=5,this.vx=Math.max(this.vx,5)):"lastChance"==t&&this.giveLastChance()}giveBounce(t){this.bounceType=t}giveBoost(){this.vx+=20}giveLastChance(){this.vx=30,this.vy=-35}}(g,c),w=new class{constructor(){this.items=[],this.notSpecialItem=this.notSpecialItem.bind(this)}drawItems(t,i,s){var h="",e=document.getElementById("gameWindow").getContext("2d");this.items.length>0&&this.items[0].width+this.items[0].x<t&&this.items.shift();for(let o of this.items){let a=10,n=o.x-a,l=o.x+o.width+a,d=o.y-a,r=o.y+o.height+a;i<l&&i>n&&s<r&&s>d&&(h=o.name,this.notSpecialItem(o.name)&&(o.x=t-o.width)),e.beginPath(),e.rect(o.x,o.y,o.width,o.height),e.fillStyle=o.color,e.fill(),e.closePath()}return h}notSpecialItem(t){return"yBoost"!==t}},m=new class{constructor(t,i){this.groundObjs=[0,t,2*t],this.y=i,this.heigth=50,this.canvas=document.getElementById("gameWindow")}draw(t){var i=this.canvas.getContext("2d");this.groundObjs[0]+this.canvas.width<t&&(this.groundObjs.shift(),this.groundObjs.push(this.groundObjs[this.groundObjs.length-1]+this.canvas.width));for(const t of this.groundObjs){let s=10*t/this.canvas.width;i.beginPath(),i.rect(t,this.canvas.height-20,this.canvas.width,50),i.rect(t,this.canvas.height-40,10,60),i.font="20px Roboto",i.fillStyle="#4A5899",i.fillText(s+"m",t,this.canvas.height-50),i.fill(),i.closePath()}}addHorizontalMarkers(t,i,s){var h=this.canvas.getContext("2d");for(let e=1;e<50;++e){let o=this.canvas.height-e*i,a=5*e;Math.abs(s-o)<this.canvas.height&&(h.beginPath(),h.rect(t,o,this.canvas.width,2),h.fillStyle="#090809",h.font="20px Roboto",h.fillText(a+"m",t,o-2),h.fill(),h.closePath())}}addObj(t){this.groundObjs.push(t)}}(d.width,v),f=new class{constructor(){this.clouds=[],this.addCloud=this.addCloud.bind(this)}addCloud(t,i,s){let h=n(s=Math.min(s,0),i-300+s),e=new l(t,h,300,100);this.clouds.push(e)}resetClouds(){this.clouds[0].x=n(10,this.clouds[0].width);for(let t=1;t<this.clouds.length;++t)this.clouds[t].x=this.clouds[t-1].x+n(this.clouds[t-1].width+100,this.clouds[t-1].width+600)}draw(t,i,s){var h=document.getElementById("gameWindow"),e=h.getContext("2d");e.save(),e.globalCompositeOperation="destination-over",e.globalAlpha=.8;for(let t of this.clouds)t.x=t.x+.8*i,t.y=t.y+.2*s,e.beginPath(),e.rect(t.x,t.y,t.width,t.height),e.fillStyle=t.color,e.fill(),e.closePath();if(e.restore(),0!=this.clouds.length&&this.clouds[0].x<t-this.clouds[0].width){let i=n(h.width,h.width+100);this.addCloud(t+i,h.height,this.clouds[0].y-this.clouds[0].startY),this.clouds.shift()}}};f.addCloud(n(0,d.width/4),d.height,0),f.addCloud(n(d.width/2,d.width),d.height,0),d.width,d.width;var b=!1;!function a(){var l=x.x-g,p=x.y-c;if(r.clearRect(l,p-d.height,d.width,2*d.height),b){let a=n(0,80+500/x.vx),r=l+d.width,c=Math.max(p-2*d.height,u),g=n(Math.min(p+2*d.height,v-100),c);a<3?w.items.push(new t(r,g)):a<4?w.items.push(new s(r,g)):a<6?w.items.push(new h(r,g)):a<8?w.items.push(new e(r,g)):a<18?w.items.push(new i(r,g)):a<19&&w.items.push(new o(r,v))}m.draw(l),function(t){m.addHorizontalMarkers(t,y,x.y)}(l);let C=w.drawItems(l,x.x,x.y);""!==C&&x.applyItem(C),x.draw(),x.y>=d.height/2?f.draw(l,x.vx,0):f.draw(l,x.vx,x.vy),x.lost&&(alert("Game over!"),x.reset(g,c),b=!1,w.items=[],m.groundObjs=[0,d.width,2*d.width],f.resetClouds()),requestAnimationFrame(a)}(),document.addEventListener("keydown",(function(t){32===t.keyCode?(x.flap(),b=!0):27===t.keyCode||80===t.keyCode?pauseGame():65===t.keyCode?x.giveLastChance():83===t.keyCode&&x.giveBoost()}))})();