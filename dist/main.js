(()=>{"use strict";class t{constructor(t,i){this.name="xBoost",this.x=t,this.y=i,this.width=80,this.height=20,this.color="#8AC926"}}class i{constructor(t,i){this.name="fullBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#FCF300"}}class h{constructor(t,i){this.name="halfBounce",this.x=t,this.y=i,this.width=40,this.height=40,this.color="#F9627D"}}function s(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t)+t)}class e{constructor(t,i,h,s){this.startY=i,this.x=t,this.y=i,this.width=h,this.height=s,this.color="#F7F4EA"}}var o=document.getElementById("gameWindow"),a=o.getContext("2d");const n=o.height/2,l=o.width/8,d=o.width/2,r=-10*o.height,c=o.height-20;var g=new class{constructor(t,i){this.size=20,this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.maxVelY=40,this.lost=!1,this.dt=.5,this.energyY=20,this.energyX=196,this.drawEnergy=this.drawEnergy.bind(this),this.color="#FF9505"}draw(){var t=document.getElementById("gameWindow"),i=t.getContext("2d");let h=t.height/2,s=t.width/8;this.drawEnergy(t),i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fillStyle=this.color,i.fill(),i.closePath(),i.restore(),this.vx>0?this.vx-=this.ax*this.dt:this.vx=0,this.x+=this.vx,i.translate(-this.vx,0),this.vy!==this.maxVelY&&(this.vy+=this.ay*this.dt),this.y<t.height-this.size||this.vy<0?(this.y+=this.vy*this.dt,this.y<h?(i.translate(0,-this.vy*this.dt),this.energyY+=this.vy*this.dt):(i.setTransform(1,0,0,1,0,0),i.translate(s-this.x,0),this.energyY=20)):0!==this.bounceType?(this.vy=-this.bounceType*this.vy,this.bounceType=0,this.color="#FF9505"):(this.vy=0,this.lost=!0)}drawEnergy(t){this.lost||(this.energyX=Math.min(196,this.energyX+.5));var i=t.getContext("2d");i.beginPath(),i.rect(this.x+t.width-350,this.energyY,200,20),i.fillStyle="#090809",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348,this.energyY+2,this.energyX,16),i.fillStyle="#D7263D",i.fill(),i.closePath(),i.beginPath(),i.rect(this.x+t.width-348+55,this.energyY-2,2,20),i.fillStyle="#FF9505",i.fill(),i.closePath()}reset(t,i){this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.lost=!1}flap(){if(0===this.vx&&0===this.vy)return this.energyX=Math.max(this.energyX-55,0),this.vx=25,this.ax=.1,this.vy=-20,void(this.ay=1);this.energyX>=55&&(this.energyX=Math.max(this.energyX-55,0),this.vy=-15,this.vx+=2)}applyItem(t){"xBoost"===t?this.giveBoost():"fullBounce"===t?(this.giveBounce(1.5),this.color="#FCF300"):"halfBounce"===t&&(this.giveBounce(.75),this.color="#F9627D")}giveBounce(t){this.bounceType=t}giveBoost(){this.vx+=20}giveLastChance(){console.log("Does nothing right now")}}(l,n),y=new class{constructor(){this.items=[]}drawItems(t,i,h){var s="",e=document.getElementById("gameWindow").getContext("2d");this.items.length>0&&this.items[0].width+this.items[0].x<t&&this.items.shift();for(let o of this.items){let a=10,n=o.x-a,l=o.x+o.width+a,d=o.y-a,r=o.y+o.height+a;i<l&&i>n&&h<r&&h>d&&(s=o.name,o.x=t-o.width),e.beginPath(),e.rect(o.x,o.y,o.width,o.height),e.fillStyle=o.color,e.fill(),e.closePath()}return s}},u=new class{constructor(t,i){this.groundObjs=[0,t,2*t],this.y=i,this.heigth=50,this.canvas=document.getElementById("gameWindow")}draw(t){var i=this.canvas.getContext("2d");this.groundObjs[0]+this.canvas.width<t&&(this.groundObjs.shift(),this.groundObjs.push(this.groundObjs[this.groundObjs.length-1]+this.canvas.width));for(const t of this.groundObjs){let h=10*t/this.canvas.width;i.beginPath(),i.rect(t,this.canvas.height-20,this.canvas.width,50),i.rect(t,this.canvas.height-40,10,60),i.font="20px Roboto",i.fillStyle="#4A5899",i.fillText(h+"m",t,this.canvas.height-50),i.fill(),i.closePath()}}addHorizontalMarkers(t,i,h){var s=this.canvas.getContext("2d");for(let e=1;e<50;++e){let o=this.canvas.height-e*i,a=5*e;Math.abs(h-o)<this.canvas.height&&(s.beginPath(),s.rect(t,o,this.canvas.width,2),s.fillStyle="#090809",s.font="20px Roboto",s.fillText(a+"m",t,o-2),s.fill(),s.closePath())}}addObj(t){this.groundObjs.push(t)}}(o.width,c),v=new class{constructor(){this.clouds=[],this.addCloud=this.addCloud.bind(this)}addCloud(t,i,h){let o=s(h=Math.min(h,0),i-300+h),a=new e(t,o,300,100);this.clouds.push(a)}resetClouds(){this.clouds[0].x=s(10,this.clouds[0].width);for(let t=1;t<this.clouds.length;++t)this.clouds[t].x=this.clouds[t-1].x+s(this.clouds[t-1].width+100,this.clouds[t-1].width+600)}draw(t,i,h){var e=document.getElementById("gameWindow"),o=e.getContext("2d");o.save(),o.globalAlpha=.8;for(let t of this.clouds)t.x=t.x+.8*i,t.y=t.y+.2*h,o.beginPath(),o.rect(t.x,t.y,t.width,t.height),o.fillStyle=t.color,o.fill(),o.closePath();if(o.restore(),0!=this.clouds.length&&this.clouds[0].x<t-this.clouds[0].width){let i=s(e.width,e.width+100);this.addCloud(t+i,e.height,this.clouds[0].y-this.clouds[0].startY),this.clouds.shift()}}};v.addCloud(s(0,o.width/4),o.height,0),v.addCloud(s(o.width/2,o.width),o.height,0),o.width,o.width;var w=!1;!function e(){var x=g.x-l,m=g.y-n;if(w){let e=s(0,80+500/g.vx),a=x+o.width,n=Math.max(m-2*o.height,r),l=s(Math.min(m+2*o.height,c-100),n);e<3?y.items.push(new t(a,l)):e<6?y.items.push(new i(a,l)):e<9&&y.items.push(new h(a,l))}a.clearRect(x,m-o.height,o.width,2*o.height),u.draw(x),g.y>=o.height/2?v.draw(x,g.vx,0):v.draw(x,g.vx,g.vy),function(t){u.addHorizontalMarkers(t,d,g.y)}(x);let f=y.drawItems(x,g.x,g.y);""!==f&&g.applyItem(f),g.draw(),g.lost&&(alert("Game over!"),g.reset(l,n),w=!1,y.items=[],u.groundObjs=[0,o.width,2*o.width],v.resetClouds()),requestAnimationFrame(e)}(),document.addEventListener("keydown",(function(t){32===t.keyCode&&(g.flap(),w=!0)})),document.addEventListener("keydown",(function(t){65===t.keyCode?g.giveBounce():83===t.keyCode||68===t.keyCode?g.giveBoost():70===t.keyCode&&g.giveLastChance()}))})();