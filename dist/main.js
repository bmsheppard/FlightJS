(()=>{"use strict";class t{constructor(t,i){this.name="xBoost",this.x=t,this.y=i,this.width=80,this.height=20,this.color="orange"}}var i=document.getElementById("gameWindow"),s=i.getContext("2d");const h=i.height/2,e=i.width/8,o=i.width/2;var a=new class{constructor(t,i){this.size=20,this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.maxVel=40,this.lost=!1,this.dt=.5}draw(){var t=document.getElementById("gameWindow"),i=t.getContext("2d");let s=t.height/2,h=t.width/8;i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fillStyle="red",i.fill(),i.closePath(),i.restore(),this.vx>0?this.vx-=this.ax*this.dt:this.vx=0,this.x+=this.vx,i.translate(-this.vx,0),this.vy!==this.maxVel&&(this.vy+=this.ay*this.dt),this.y<t.height-this.size||this.vy<0?(this.y+=this.vy*this.dt,this.y<s?i.translate(0,-this.vy*this.dt):(i.setTransform(1,0,0,1,0,0),i.translate(h-this.x,0))):1===this.bounceType?(this.vy=-this.vy,this.bounceType=0):(this.vy=0,this.lost=!0)}reset(t,i){this.x=t,this.vx=0,this.ax=0,this.y=i,this.vy=0,this.ay=0,this.lost=!1}flap(){if(0===this.vx&&0===this.vy)return this.vx=15,this.ax=.1,this.vy=-10,void(this.ay=1);this.vy=-15,this.vx+=2}applyItem(t){"xBoost"===t?this.giveBoost():"fullBounce"===t&&this.giveBounce()}giveBounce(){this.bounceType=1}giveBoost(){this.vx+=0}giveLastChance(){console.log("Does nothing right now")}}(e,h),n=new class{constructor(){this.items=[]}drawItems(t,i,s){var h="",e=document.getElementById("gameWindow").getContext("2d");this.items.length>0&&this.items[0].width+this.items[0].x<t&&this.items.shift();for(let o of this.items){let a=10,n=o.x-a,d=o.x+o.width+a,r=o.y-a,l=o.y+o.height+a;i<d&&i>n&&s<l&&s>r&&(h=o.name,o.x=t-o.width),e.beginPath(),e.rect(o.x,o.y,o.width,o.height),e.fillStyle=o.color,e.fill(),e.closePath()}return h}},d=new class{constructor(t){this.groundObjs=[0,t,2*t],this.canvas=document.getElementById("gameWindow")}draw(t){var i=this.canvas.getContext("2d");this.groundObjs[0]+this.canvas.width<t&&(this.groundObjs.shift(),this.groundObjs.push(this.groundObjs[this.groundObjs.length-1]+this.canvas.width));for(const t of this.groundObjs){let s=10*t/this.canvas.width;i.beginPath(),i.rect(t,this.canvas.height-20,this.canvas.width,50),i.rect(t,this.canvas.height-40,10,60),i.font="20px Roboto",i.fillStyle="blue",i.fillText(s+"m",t,this.canvas.height-50),i.fill(),i.closePath()}}addHorizontalMarkers(t,i,s){var h=this.canvas.getContext("2d");for(let e=1;e<50;++e){let o=this.canvas.height-e*i,a=5*e;Math.abs(s-o)<this.canvas.height&&(h.beginPath(),h.rect(t,o,this.canvas.width,2),h.fillStyle="green",h.font="20px Roboto",h.fillText(a+"m",t,o-2),h.fill(),h.closePath())}}addObj(t){this.groundObjs.push(t)}}(i.width),r=(i.width,i.width,!1);!function l(){var c,v,g=a.x-e,y=a.y-h;if(r&&(c=0,v=100,c=Math.ceil(c),v=Math.floor(v),Math.floor(Math.random()*(v-c)+c)<1)){let s=g+i.width;n.items.push(new t(s,i.height/2))}s.clearRect(g,y-i.height,i.width,2*i.height),d.draw(g),function(t){d.addHorizontalMarkers(t,o,a.y)}(g);let x=n.drawItems(g,a.x,a.y);""!==x&&a.applyItem(x),a.draw(),a.lost&&(alert("Game over!"),a.reset(e,h),r=!1,n.items=[],d.groundObjs=[0,i.width,2*i.width]),requestAnimationFrame(l)}(),document.addEventListener("keydown",(function(t){32===t.keyCode&&(a.flap(),r=!0)})),document.addEventListener("keydown",(function(t){65===t.keyCode?a.giveBounce():83===t.keyCode||68===t.keyCode?a.giveBoost():70===t.keyCode&&a.giveLastChance()}))})();